# Comic2Kindle

#### Video demo: https://youtu.be/aAC5S6oraQw

#### Description:

This is a webapp that will allow you to convert series of images into .azw3 files, a filetype that is natively supported by the latest Kindle models. The way it works is that you select a folder that contains the images you would like to convert. Before submitting, you can choose to upload multiple folders that will be converted into seperate .azw3 files. Then there is also a checkbox which will allow you to convert the images in "manga mode", which will switch the page reading order from left to right to right to left. After submitting, the images will be converted into a .azw3 file, and you will be able to download it. The webapp will automatically generate titles for the .azw3 files based on the folder names.

The webapp has a frontend and a seperate backend API. The frontend is built with React, and it also uses TailwindCSS for styling. I chose React because it is the industry standard for frontend development, and I wanted to get more experience with it. React's different libraries are also very useful. For example axios, which i used when making requests to the backend API. Tailwind is an easy to use and highly readable way of constructing CSS, and it is my preferred way of styling websites. I also opted to use TypeScript to help with type correction and to help me get more used to using types in JavaScript. Currently I am also hosting the frontend on Vercel, a service which allows free hosting of small projects.

For the backend, I used Flask, a lightweight Python web framework. I chose Python because while wanting more experience with it, I also felt it would fit well considering Python's great image processing libraries. And i chose Flask specifically because it is lightweight and easy to use, which fits better for this project rather than having to set up a Django project. The API is currently not hosted anywhere, mostly because it will require more time to consider and set up a good solution for it. It runs well on my local machine, but I am looking into hosting it on either Heroku or AWS.

On the frontend side, there is a file input form that uses webkitdirectory, which allows the user to select directories (folders) to upload. The directory will be added to the "fileInfos" state, which is an array of objects that for each file, contains the file itself, and the name of the directory it came from. I chose to design it this way to be able to differentiate files by the directory they came from, otherwise the API wouldn't know which files belong to which .azw3 file. There is also an error state, which will display different messages according to what error the user is receiving. When the user clicks submit, a POST request will be sent to the API's /convert endpoint, which will begin the conversion process. A conversion ID will be generated, and the files will be saved on the server. A threaded background process will start that performs the rest of the conversion from there on. The reason for using a thread is that it allows the rest of the API to periodically return the progress of the conversion, which lets me display a progress bar on the frontend.

First the API has to convert the images to EPUB format, and Python can do this without the need of any libraries. I formerly tried using different epub libraries, but found that my usecase was specific enough that the result would be better if I had my own custom implementation. Essentially, the API will create a .xhtml file for each image file, and then create a .opf file that will reference all the .xhtml files. The .opf file will also contain metadata such as the title of the book, the author, and the cover image. The API will then zip all the files into a .epub file.
The next step is much simpler. The API will use Calibre's ebook-convert command line tool to convert the .epub file into a .azw3 file. Calibre is a great open source ebook management tool that fit my needs perfectly. The frontend will then be notified that the .azw3 file is ready for download, and a download button will be displayed. Clicking it will deliver a zipped file containing all the .azw3 files that were converted.

#### Future considerations:

There are ways that I would like to improve the webapp in the future. Most importantly I need to remove the extra margin around the pages of the resulting .azw3 file when viewed on a kindle. Next I wish to improve the progress bar so it shows progress more incrimentally. Also it bothers me that cover images won't display on the Kindle. This is a known bug with Kindles and the only solution I have heard of is to use Calibre while moving files to the Kindle, however this goes against my idea of the user not needing to download any software to convert their images to kindle.
